\chapter{Lösungsansätze}
% Noch nicht auf spezielle technische Lösungen eingehen!

\section{Authentizität der Records}
\label{sec:Solution-RecordAuth}

Wie in Kapitel \ref{sec:Thread-Auth} beschrieben wurde, ist die Authentizität der RR ein zentrales Problem in DNS. Zur Lösung wurde schon früh der Einsatz kryptografischer Signaturen postuliert. Mithilfe dieser könnten alle Einträge bei der Erstellung signiert, zusammen mit den Signaturen übertragen und dann von der Gegenstelle validiert werden. Dadurch wird es möglich die Integrität und Authentizität der empfangenen Einträge eindeutig sicherzustellen. Werden die Zonendateien nur bei Änderung signiert und der private Schlüsselteil anschließend wieder entfernt, besteht sogar die Möglichkeit Server-Konfigurationen vor ungewollter Veränderung zu schützen. 
Die zentralen Fragen sind dabei, wie bei allen Signaturverfahren, das Schlüsselmanagement und die damit verbundene Vertrauensstellung zwischen den einzelnen Parteien. Das notwendige Vertrauen kann dabei auf verschiedenste Wege erreicht werden. Die gängigsten Methoden sind "Chain-of-trust", "Web-of-trust", "Shared Key" und "Trust-On-First-Use" (TOFU). Wie im folgenden Kapitel beschrieben wird, beantworten die unterschiedlichen Technologien diese Frage auf diverse weise, wobei zumindest TOFU als unzureichend Sicher eingestuft werden kann \cite{Wendlandt2008}.
Des weitern ist zu erwähnen , dass die Integrität der Nachrichten trotz Signatur nicht immer garantiert werden kann. Einige Signaturmechanismen, konkret die darin genützten Hash-Algorithmen, weisen bekannte Schwächen aus, die bei einem Angriff ausgenützt werden können. Modernes Beispiel stellt dabei der Angriff "Shattered" auf den SHA-1 Algorithmus dar \cite{Stevens2017}. 

\section{Authentizität der Endstelle}

In Kapitel \ref{sec:Thread-Auth} wurde erwähnt, dass es in DNS-Netzwerkprotokoll keine Möglichkeit gibt die Authentizität der Gegenstelle zu prüfen. Abhilfe für dieses Problem schafft einerseits das zuvor besprochene kryptographische Signieren der Einträge, da so bei einem Eingriff keine unbemerkte Modifikation des Inhalts möglich ist. Dieser Schutz scheitert jedoch an der praktischen Umsetzung, da es einen Fallback-Mechanismus ausschließen müsste, da ansonsten eine Downgrade-Attacke möglich wäre. Bei diesem Angriff werden die die Signaturen aus dem Antwort-Paket entfernt, was bei einem Client zu dem Eindruck führt, dass der Server die Unterstützung von Signaturen eingestellt hat. Die meisten Implementierungen würden diesen Umstand ignorieren und somit die potenziell gefälschten Antworten akzeptieren.  

Der erste Schritt zur Lösung dieses Problem stellt das einführen eines Authentifizierungsverfahren dar. In den meisten Fällen wird dafür eine asymmertischer Kryptografie basierende Methode eingesetzt. Dieses besteht aus 2 Schritten: Als erstes teilt die fragliche Endstelle seinen öffentlichen Schlüssel mit, der Client trifft nun eine Entscheidung ob er dem Schlüssel vertraut oder nicht. Wir schon in Abschnitt \ref{sec:Solution-RecordAuth} erwähnt, gibt es dafür verschiedene Methoden um das notwendige Vertrauen zu dem gegebenen Schlüssel herzustellen und zu prüfen. Der zweite Schritt stellt sicher, dass die Endstelle auch im Besitz des passenden, privaten Schlüssels ist. Dabei wird oft die Authentifizierung und die Sitzungsschlüsselübertragung zusammengefasst. Der Client überträgt dabei seinen Informationsteil für die Sitzungsschüsselerstellung verschlüsselt mit dem öffentlichen Schlüssel des Gegenübers. Eine erfolgreiche Aushandlung des Sitzungsschlüssels ist damit nur möglich wenn die Endstelle die Nachricht auch entschlüsseln kann, was nur mit passendem privaten Schlüssel möglich sein sollte. 

\section{Vertraulichkeit der Verbindung}

Obwohl die Integrität und Authentizität der Nachrichten eines der größten Probleme für DNS darstellt, ist speziell DNS-Privicy zu einem wichtigen Thema geworden. Die nachhaltige Lösung zur Sicherstellung der Vertraulichkeit ist, wie damals auch bei HTTP, der Einsatz einer geeigneten Verschlüsselungstechnologie. Auf welcher Ebene diese Stattfindet ist dafür grundsätzlich nicht relevant. Der Einsatz von etablierten Technologien wie TLS liegt jedoch nahe, obwohl für DNS auch eigene Lösungen entwickelt wurden. So stellt der Umstand, dass DNS primär auf UDP aufbaut eine Hürde beim Einsatz von TLS dar, welches ein verbindungsorientiertes Protokoll wie TCP vorschreibt.

\section{Vertraulichkeit der Anfragen}

Ein in der Vergangenheit wenig beachtetes Problem ist die Vertraulichkeit der Anfragen selbst und damit das notwendige Vertrauen an die Betreibenden der DNS-Infrastruktur selbst. Speziell Rekursive Resolver von großen ISPs akkumulieren eine große Menge an DNS-Daten, welche auf vergleichsweise einfache Art zur Nachvollziehung von Kommunikationsverläufe der Nutzenden herangezogen werden kann. Zum umgehen dieser Schwachstelle gibt es zwei getrennte Entwürfe.

Auf der einen Seite gibt es Vorschläge die darauf abzielen personenbezogene Informationen wie die IP-Adresse bewusst von den Anfragedaten zu trennen. Dafür wird der Umstand ausgenützt, dass es möglich ist die Anfragen- und Antwortdaten von den Kommunikationsdaten zu trennen. Dies wird durch einen, für den Recursive Resolver transparente, Ende-zu-Ende-Verschlüsselung zwischen Stub Resolver und einem speziellen DNS-Server möglich. Der DNS-Server entschlüsselt dabei die erhaltene Anfrage und löst diese rekursiv auf, verschlüsselt die Antwort und sendet diese an der Recursive Resolver zurück, welcher die Antwort an den Client weiterreicht. Durch dieses Verfahren kann der Recursive Resolver weder Anfrage noch Antwort lesen, wobei der eigentlich auflösende Server zwar die Daten aber keinen Hinweis auf die Identität des Client erhält.

Ein komplett anderer Entwurf basiert auf der Ablöse des DNS als Gesamtheit, da davon ausgegangen wird, das DNS, aufgrund seines Grundkonzepts, nie strengen Ansprüchen auf Vertraulichkeit genügen wird. Diese Alternativkonzepte bauen die für ein Namensauflösungssystem notwendige verteile Datenbank mithilfe von Technologien wie Dirstibute-Hash-Tables (DHT) oder Public Ledger auf Blockchain-basis auf. Da diese Lösungsentwürfe radikal vom bestehenden Konzept des DNS abweichen, werden sie hier nicht weiter behandelt.      

\section{Denial-Of-Service}

Über die Zeit sind verschiedenste Lösungsvorschläge zum, in Abschnitt \ref{sec:Thread-DosAmp} behandelten, Problem der DoS-Verstärkung ausgearbeitet worden. Die einfachste Möglichkeit einer Lösung besteht im Ablösen des Verbindungslosen UDP zugunsten eines Verbindungsorientierten Protokolls wir TCP. Der notwendige Verbindungsaufbau könnte im Falle eines klassischen IP-Spoofings nicht abgeschlossen werden, was das stellen einer Anfrage verhindern würde. Damit wäre DNS nicht mehr als Verstärker nutzbar. Die Nachteile dieser Lösung bestehen jedoch in ihrem Vorteil, da der Verbindungsaufbau viel Zeit in Anspruch nimmt und zusätzliche Ressourcen auf dem Server binden würde. Wie Zuh et al. \cite{Zhu2015} jedoch feststellen konnte, ist die Auswirkung auf die Performance in den meisten Fällen jedoch stark überschätzt. In seiner Arbeit wurde festgestellt, dass bei einer TLS Verbindung wischen Stub-Resolver und Recursive Resolver lediglich 21\% Zeitverlust auftritt, wobei die Ressourcenerhöhung bei den meisten Resolvern vernachlässigbar ist. 

Sieht man dennoch von diesen Umständen ab und konzentriert man sich auf eine Lösung bei minimaler Änderung der bestehenden Vorgehensweisen, werden von Anagnostopoulos et al.\cite{Anagnostopoulos2013} und van Rijswijk-Deij et at.\cite{VanRijswijk-Deij2014} folgende Punkte vorgeschlagen.

\textbf{Source validation:} Router an Netzwerkübergängen (z.B. ISP zu Internet-Backbone) können die IP-Quelladresse von ausgehenden Paketen prüfen. Wird erkannt, dass die Adresse nicht aus dem eigenen IP-Adressraum kommt, sollte diese verworfen werden. Dies beugt IP-Spoofing im allgemeinen vor und verhindert so Angriffe aus dem eigenen Netz auf andere Netzwerkteilnehmer.

\textbf{Deaktivieren von offenen Resolvern:} Diese Empfehlung richtet sich an alle Betreiber von rekursiv auflösenden Nameservern und empfiehlt keine Anfragen von Client-Adressen außerhalb des eigenen Adressraums zuzulassen. Dies würde das Ausnutzen von Resolvern als DoS-Verstärker massiv erschweren. Obwohl dieser Ratschlag formal richtig ist, zeigt der aktuelle Trend eher Richtung Trusted Resolver wie Google DNS und Quad9, die per Definition von allen Netzen aus erreichbar sind. Die Empfehlung sollte also insofern verstanden werden, dass private Resolver nur von den vorgesehenen Clients erreichbar sein sollten.

\textbf{DNS Amplification Detection:} Wie Kambourakis et al.\cite{Kambourakis2008} sowie Kim et al.\cite{Kim2011} zeigen ist das erkennen von DNS-Amplification-Attacken zwar überaus komplex, aber durchführbar. Große Netzwerkbetreiber sollten die in den Arbeiten genannten Methoden andenken in implementieren.

\textbf{DNS Response Rate Limiting (DNS RRL):} Diese Technologie limitiert die Anzahl an gleichen Anfragen pro Quelladresse pro Zeiteinheit. Diese Limitierung macht speziell bei authoritativen DNS-Servern Sinn, da die anfragenden Recursive Resolver die erhaltenen Anfragen im Cache behalten. Größere cone-NAT Installationen mit mehreren Resolvern oder Resolver ohne cache werden somit jedoch ebenfalls beeinträchtigt. Van Rijswijk-Deij et at.\cite{VanRijswijk-Deij2014} schlägt als abgeschwächte Variante das Beschränken von ANY-Anfragen vor, da diese, aufgrund des hohen Anfrage- zu Antwort-Größenverhältnisses, ein, im Vergleich zu anderen Anfrage-Typen, unverhältnismäßig hohes Schadenspotenzial darstellen.